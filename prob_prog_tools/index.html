<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Jacob Rider">
        <link rel="canonical" href="https://Grow-Myelin.github.io/prob_prog_tools/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Probabilistic Programming Tools - Jacob Rider's Personal Portfolio</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atelier-cave-light.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">Jacob Rider's Personal Portfolio</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="../experience/" class="nav-link">Experience</a>
                            </li>
                            <li class="navitem">
                                <a href="../education/" class="nav-link">Education</a>
                            </li>
                            <li class="navitem">
                                <a href="../skills/" class="nav-link">Skills</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Projects <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../ti4_combat_simulator/" class="dropdown-item">TI4 Combat Simulator</a>
</li>
                                    
<li>
    <a href="../baseball_pitch_predictor/" class="dropdown-item">Baseball Pitch Predictor</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Probabilistic Programming Tools</a>
</li>
                                    
<li>
    <a href="../data_tools/" class="dropdown-item">Data Tools for Economic Research</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../contact/" class="nav-link">Contact</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../baseball_pitch_predictor/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../data_tools/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#probabilistic-programming-tools" class="nav-link">Probabilistic Programming Tools</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#technologies-used" class="nav-link">Technologies Used</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#project-overview" class="nav-link">Project Overview</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#key-features" class="nav-link">Key Features</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#imports" class="nav-link">Imports</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#classes" class="nav-link">Classes</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#methods" class="nav-link">Methods</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#functions" class="nav-link">Functions</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#example-usage" class="nav-link">Example Usage</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="probabilistic-programming-tools">Probabilistic Programming Tools</h1>
<p><strong><a href="https://github.com/Grow-Myelin/ProbProg/tree/main/ProbProgTools">View Project on GitHub</a></strong></p>
<h2 id="technologies-used">Technologies Used</h2>
<ul>
<li>Python</li>
<li>NumPy</li>
<li>Jax</li>
<li>NumPyro</li>
</ul>
<h2 id="project-overview">Project Overview</h2>
<p>Designed tools that simulate a random levy process and then uses NumPyro to infer the parameters used to simulate those processes.</p>
<h2 id="key-features">Key Features</h2>
<ul>
<li>Simulation of processes that resemble stock price movements using random levy processes.</li>
<li>Parameter inference with NumPyro to understand underlying market dynamics.</li>
</ul>
<h2 id="imports">Imports</h2>
<pre><code class="language-python">from scipy.stats import levy_stable
from jax.scipy.linalg import cholesky
from typing import Dict, List, Tuple
import os
from typing import Any, Dict
import jax
import jax.numpy as jnp
import matplotlib.pyplot as plt
import numpyro
import numpyro.distributions as dist
import seaborn as sns
from numpyro.infer import MCMC, NUTS
</code></pre>
<h2 id="classes">Classes</h2>
<h3 id="stockmarketsimulator">StockMarketSimulator</h3>
<pre><code class="language-python">class StockMarketSimulator:
    &quot;&quot;&quot;
    A simulator for stock market prices using Levy processes with JAX for computation and
    Pareto-distributed initial prices using NumPy.

    Attributes:
        n_industries (int): Number of industries.
        n_stocks_per_industry (int): Number of stocks per industry.
        base_stock_price (float): Base stock price for scaling initial prices.
        industries (List[str]): List of industry names.
        stocks (List[str]): List of stock symbols.
        stock_prices (pd.DataFrame): DataFrame to store simulated stock prices.
        seed (int): Int derived through os for true random state
        key (jax.random.PRNGKey): JAX PRNG key for random number generation.
        industry_map (Dict[str, str]): Mapping of stocks to their respective industries.
        alpha_params (Dict[str, float]): Alpha parameter for each industry.
        beta_params (Dict[str, float]): Beta parameter for each industry.
        pareto_shapes (Dict[str, float]): Pareto shape parameter for each industry.
    &quot;&quot;&quot;
</code></pre>
<h2 id="methods">Methods</h2>
<h3 id="init"><strong>init</strong>()</h3>
<pre><code class="language-python">def __init__(self, n_industries: int = 8, n_stocks_per_industry: int = 10, base_stock_price: float = 100) -&gt; None:
    &quot;&quot;&quot;
    Initialize the stock market simulator with specified parameters.

    Args:
        n_industries (int): The number of industries to simulate.
        n_stocks_per_industry (int): The number of stocks per industry.
        base_stock_price (float): The base stock price for scaling initial prices.
    &quot;&quot;&quot;
</code></pre>
<h3 id="_initialize_prices">_initialize_prices()</h3>
<pre><code class="language-python">def _initialize_prices(self) -&gt; None:
    &quot;&quot;&quot;Initialize the stock prices using Pareto distribution for each industry.&quot;&quot;&quot;
</code></pre>
<h3 id="_simulate_stock_prices">_simulate_stock_prices()</h3>
<pre><code class="language-python">def simulate_stock_prices(self, n_days: int = 252) -&gt; pd.DataFrame:
    &quot;&quot;&quot;
    Simulate stock prices over a given number of days.

    Args:
        n_days (int): The number of days to simulate stock prices.

    Returns:
        pd.DataFrame: A DataFrame containing the simulated stock prices.
    &quot;&quot;&quot;
</code></pre>
<h3 id="_apply_correlation">_apply_correlation</h3>
<pre><code class="language-python">def _apply_correlation(self, increments: np.ndarray) -&gt; np.ndarray:
    &quot;&quot;&quot;
    Apply a correlation matrix to the increments using Cholesky decomposition.

    Args:
        increments (np.ndarray): An array of increments to apply correlation to.

    Returns:
        np.ndarray: Correlated increments after applying the correlation matrix.
    &quot;&quot;&quot;
</code></pre>
<h2 id="functions">Functions</h2>
<h3 id="plot_posteriors">plot_posteriors()</h3>
<pre><code class="language-python">def plot_posteriors(posterior_samples: Dict[str, jnp.ndarray], industry: str) -&gt; None:
    &quot;&quot;&quot;
    Plots the posterior distributions for a given industry.

    Args:
        posterior_samples: Samples from the posterior distribution as a dictionary where keys are parameter names.
        industry (str): The name of the industry for which the posterior distributions are plotted.
    &quot;&quot;&quot;
</code></pre>
<h3 id="run_bayesian_inference">run_bayesian_inference()</h3>
<pre><code class="language-python">def run_bayesian_inference(simulator: DI.StockMarketSimulator, n_samples: int = 500, n_warmup: int = 100) -&gt; None:
    &quot;&quot;&quot;
    Runs Bayesian inference for each industry and plots the posterior distributions.

    Args:
        simulator: An instance of StockMarketSimulator containing stock prices and industry mappings.
        n_samples (int): Number of samples to draw from the posterior distribution.
        n_warmup (int): Number of warmup steps for the sampler.
    &quot;&quot;&quot;
</code></pre>
<h3 id="plot_stock_prices">plot_stock_prices()</h3>
<pre><code class="language-python">def plot_stock_prices(simulator: DI.StockMarketSimulator) -&gt; None:
    &quot;&quot;&quot;
    Plot the simulated stock prices for all stocks in the simulation.

    Args:
        simulator (DI.StockMarketSimulator): An instance of the StockMarketSimulator class.

    This function generates a line plot for each stock across the simulated days and saves the plot
    to a file named 'simulated_stock_prices.png' in the 'plots' directory.
    &quot;&quot;&quot;
</code></pre>
<h3 id="plot_stock_prices_by_industry">plot_stock_prices_by_industry()</h3>
<pre><code class="language-python">def plot_stock_prices_by_industry(simulator: DI.StockMarketSimulator) -&gt; None:
    &quot;&quot;&quot;
    Plot the simulated stock prices for each industry separately.

    Args:
        simulator (DI.StockMarketSimulator): An instance of the StockMarketSimulator class.

    This function generates a line plot for each stock within an industry across the simulated days and saves
    each industry's plot to a separate file in the 'plots' directory, named 'simulated_stock_price_by_[industry].png'.
    &quot;&quot;&quot;
</code></pre>
<h2 id="example-usage">Example Usage</h2>
<pre><code class="language-python">def main() -&gt; None:
    &quot;&quot;&quot;
    Main function to initialize the simulator, run the stock price simulation, and plot the results.
    &quot;&quot;&quot;
    simulator = DI.StockMarketSimulator()
    run_bayesian_inference(simulator)
    simulator.simulate_stock_prices()
    plot_stock_prices(simulator)
    plot_stock_prices_by_industry(simulator)

if __name__ == &quot;__main__&quot;:
    main()
</code></pre>
<hr />
<p><a href="../experience/">Experience</a> | <a href="../education/">Education</a> | <a href="../skills/">Skills</a> | <strong>[Projects]</strong>(projects.md) | <a href="../contact/">Contact</a></p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/jquery-3.6.0.min.js"></script>
        <script src="../js/bootstrap.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
